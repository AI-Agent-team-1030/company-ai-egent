# æ³•äººAI é€²åŒ–ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ— 2025ï¼ˆæ”¹è¨‚ç‰ˆï¼‰

**æœ€çµ‚æ›´æ–°**: 2025å¹´11æœˆ23æ—¥
**æˆ¦ç•¥**: æ³•äººå‘ã‘ã®å¿…é ˆæ©Ÿèƒ½ã‚’å«ã‚ãŸç¾å®Ÿçš„ãªãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

---

## ğŸš¨ é‡è¦ãªä¿®æ­£ç‚¹ï¼ˆåˆç‰ˆã‹ã‚‰ã®å¤‰æ›´ï¼‰

### è¿½åŠ ã•ã‚ŒãŸå¿…é ˆè¦ä»¶
1. **ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ**ï¼ˆæ³•äººã”ã¨ã®ãƒ‡ãƒ¼ã‚¿åˆ†é›¢ï¼‰
2. **æ¨©é™ç®¡ç†**ï¼ˆçµ„ç¹”ãƒ»éƒ¨ç½²ãƒ»å½¹å‰²ãƒ™ãƒ¼ã‚¹ï¼‰
3. **ãƒŠãƒ¬ãƒƒã‚¸ vs ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ˜ç¢ºåŒ–**
4. **RAGã®æœ€é©åŒ–**ï¼ˆå…¨éƒ¨å–å¾— â†’ é–¢é€£æ€§ã®é«˜ã„ã‚‚ã®ã ã‘ï¼‰
5. **é€šçŸ¥ + ã‚¿ã‚¹ã‚¯ç®¡ç†**ï¼ˆçµ„ç¹”é–“ã®ã‚¿ã‚¹ã‚¯æŒ¯ã‚Šåˆ†ã‘ï¼‰

**åˆ¤æ–­ç†ç”±**: ã“ã‚Œã‚‰ã¯ã€Œæ³•äººå‘ã‘ã€ã¨ã„ã†æ€§è³ªä¸Šã€Phase 1ï¼ˆMVPï¼‰ã‹ã‚‰å¿…è¦

---

## ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å‰æ

### ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®åŸºæœ¬æ¦‚å¿µ

```
ã€éšå±¤æ§‹é€ ã€‘
Companyï¼ˆæ³•äººï¼‰
  â”œâ”€ Departmentsï¼ˆéƒ¨ç½²ï¼‰
  â”‚    â”œâ”€ Usersï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰
  â”‚    â”œâ”€ Chatsï¼ˆãƒãƒ£ãƒƒãƒˆï¼‰
  â”‚    â”œâ”€ Knowledgeï¼ˆãƒŠãƒ¬ãƒƒã‚¸ï¼‰
  â”‚    â””â”€ Documentsï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰
  â””â”€ Settingsï¼ˆè¨­å®šï¼‰

ã€æ¨©é™ãƒ¬ãƒ™ãƒ«ã€‘
1. Super Adminï¼ˆã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ï¼‰
2. Company Adminï¼ˆæ³•äººç®¡ç†è€…ï¼‰- å…¨éƒ¨è¦‹ã‚Œã‚‹
3. Department Managerï¼ˆéƒ¨é–€é•·ï¼‰- éƒ¨å†…å…¨éƒ¨è¦‹ã‚Œã‚‹
4. Memberï¼ˆãƒ¡ãƒ³ãƒãƒ¼ï¼‰- è‡ªåˆ†ã®ã ã‘è¦‹ã‚Œã‚‹
```

### ãƒŠãƒ¬ãƒƒã‚¸ vs ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å®šç¾©

```typescript
// ãƒŠãƒ¬ãƒƒã‚¸: å†åˆ©ç”¨å¯èƒ½ãªçŸ¥è­˜
interface Knowledge {
  id: string
  company_id: string
  department_id?: string  // nullãªã‚‰å…¨ç¤¾å…±æœ‰

  title: string
  content: string
  category: 'FAQ' | 'Best Practice' | 'Process' | 'Template'

  // RAGç”¨
  embedding: number[]

  // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
  created_by: string
  created_at: Date
  usage_count: number  // ä½•å›ä½¿ã‚ã‚ŒãŸã‹
  rating: number       // è©•ä¾¡ï¼ˆ1-5ï¼‰

  // ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
  visibility: 'company' | 'department' | 'private'
}

// ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: æ™‚ç³»åˆ—ã§è“„ç©ã•ã‚Œã‚‹è¨˜éŒ²
interface Document {
  id: string
  company_id: string
  department_id?: string

  title: string
  type: 'Meeting' | 'Proposal' | 'Report' | 'Contract'
  file_url?: string    // PDFãªã©ã®ãƒ•ã‚¡ã‚¤ãƒ«
  content: string      // ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡ºå¾Œ

  // RAGç”¨
  embedding: number[]

  // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
  created_by: string
  created_at: Date
  related_chat_id?: string  // ã©ã®ãƒãƒ£ãƒƒãƒˆã‹ã‚‰ç”Ÿæˆã•ã‚ŒãŸã‹

  // ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
  visibility: 'company' | 'department' | 'private'
}
```

---

## ğŸš€ Phase 1: MVPå®Œæˆï¼ˆç¾åœ¨ ã€œ 2.5ãƒ¶æœˆï¼‰

### ç›®æ¨™
**æ³•äººãŒå°å…¥ã§ãã‚‹æœ€å°é™ã®æ©Ÿèƒ½ã‚»ãƒƒãƒˆ**

---

### ğŸ¢ åŸºç›¤æ©Ÿèƒ½ï¼ˆå¿…é ˆï¼‰

#### 1. ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ ğŸ”¥ **æœ€å„ªå…ˆ**

**Supabaseã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆ:**

```sql
-- æ³•äººãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE companies (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  name TEXT NOT NULL,
  plan TEXT CHECK (plan IN ('starter', 'standard', 'enterprise')),
  max_users INTEGER,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  settings JSONB DEFAULT '{}'::jsonb
);

-- éƒ¨ç½²ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE departments (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  company_id UUID NOT NULL REFERENCES companies(id) ON DELETE CASCADE,
  name TEXT NOT NULL,
  parent_id UUID REFERENCES departments(id),  -- éšå±¤æ§‹é€ å¯¾å¿œ
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆSupabase Authã¨é€£æºï¼‰
CREATE TABLE users (
  id UUID PRIMARY KEY REFERENCES auth.users(id),
  company_id UUID NOT NULL REFERENCES companies(id) ON DELETE CASCADE,
  department_id UUID REFERENCES departments(id),

  email TEXT NOT NULL,
  name TEXT NOT NULL,
  role TEXT CHECK (role IN ('company_admin', 'department_manager', 'member')),

  created_at TIMESTAMPTZ DEFAULT NOW(),
  last_active_at TIMESTAMPTZ
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_users_company ON users(company_id);
CREATE INDEX idx_users_department ON users(department_id);
CREATE INDEX idx_departments_company ON departments(company_id);
```

**å®Ÿè£…ã‚¿ã‚¹ã‚¯:**
- [ ] Supabaseã‚¹ã‚­ãƒ¼ãƒä½œæˆ
- [ ] Row Level Securityï¼ˆRLSï¼‰è¨­å®š
- [ ] ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—æ™‚ã®æ³•äººç™»éŒ²ãƒ•ãƒ­ãƒ¼
- [ ] éƒ¨ç½²ä½œæˆãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‹›å¾…æ©Ÿèƒ½

**æˆåŠŸåŸºæº–:**
- 1ã¤ã®Supabaseã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§è¤‡æ•°æ³•äººã‚’å®‰å…¨ã«ç®¡ç†
- æ³•äººAã®ãƒ‡ãƒ¼ã‚¿ãŒæ³•äººBã‹ã‚‰è¦‹ãˆãªã„

---

#### 2. æ¨©é™ç®¡ç† ğŸ”¥ **æœ€å„ªå…ˆ**

**Row Level Securityï¼ˆRLSï¼‰ãƒãƒªã‚·ãƒ¼:**

```sql
-- ãƒãƒ£ãƒƒãƒˆã®RLSãƒãƒªã‚·ãƒ¼ä¾‹
CREATE POLICY "Users can view their company's chats"
ON chats FOR SELECT
USING (
  company_id IN (
    SELECT company_id FROM users WHERE id = auth.uid()
  )
);

-- éƒ¨ç½²é™å®šã®ãƒŠãƒ¬ãƒƒã‚¸
CREATE POLICY "Users can view department knowledge"
ON knowledge FOR SELECT
USING (
  -- å…¨ç¤¾å…±æœ‰
  visibility = 'company' AND company_id IN (
    SELECT company_id FROM users WHERE id = auth.uid()
  )
  OR
  -- éƒ¨ç½²é™å®š
  visibility = 'department' AND department_id IN (
    SELECT department_id FROM users WHERE id = auth.uid()
  )
  OR
  -- ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ
  visibility = 'private' AND created_by = auth.uid()
);
```

**å®Ÿè£…ã‚¿ã‚¹ã‚¯:**
- [ ] RLSãƒãƒªã‚·ãƒ¼è¨­è¨ˆãƒ»å®Ÿè£…
- [ ] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®æ¨©é™ãƒã‚§ãƒƒã‚¯
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ç”»é¢ï¼ˆæ³•äººç®¡ç†è€…å‘ã‘ï¼‰
- [ ] éƒ¨ç½²ç®¡ç†ç”»é¢

**æˆåŠŸåŸºæº–:**
- å–¶æ¥­éƒ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒäººäº‹éƒ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚Œãªã„
- éƒ¨é–€é•·ã¯éƒ¨å†…ã®ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚Œã‚‹

---

### ğŸ’¬ ã‚³ã‚¢æ©Ÿèƒ½

#### 3. AIãƒãƒ£ãƒƒãƒˆ + ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ğŸ”¥

**ç¾çŠ¶ã®æ”¹å–„ç‚¹:**
- âœ… RAGã§å¼•ã£å¼µã£ã¦ãã‚‹ï¼ˆè‰¯ã„ï¼‰
- âœ… ãƒãƒ£ãƒƒãƒˆå±¥æ­´ãŒè¦‹ã‚Œã‚‹ï¼ˆè‰¯ã„ï¼‰
- âŒ å…¨éƒ¨å–ã£ã¦ãã‚‹ â†’ æœ€é©ãªã‚‚ã®ã ã‘å–å¾—ã«æ”¹å–„

**RAGæœ€é©åŒ–å®Ÿè£…:**

```typescript
/**
 * ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ + ãƒªãƒ©ãƒ³ã‚­ãƒ³ã‚°
 */
async function retrieveOptimalContext(
  query: string,
  userId: string
): Promise<RetrievedContext> {
  // 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—ï¼ˆä¼šç¤¾ãƒ»éƒ¨ç½²ï¼‰
  const user = await getUserWithCompany(userId)

  // 2. ã‚¯ã‚¨ãƒªã®embeddingç”Ÿæˆ
  const queryEmbedding = await generateEmbedding(query)

  // 3. ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ï¼ˆãƒ™ã‚¯ãƒˆãƒ« + å…¨æ–‡æ¤œç´¢ï¼‰
  const results = await supabase.rpc('hybrid_search', {
    query_text: query,
    query_embedding: queryEmbedding,
    company_id: user.company_id,
    department_id: user.department_id,
    match_threshold: 0.7,
    match_count: 20  // åˆæœŸå€™è£œã¯å¤šã‚ã«å–å¾—
  })

  // 4. ãƒªãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆé–¢é€£æ€§ã®é«˜ã„é †ã«ä¸¦ã³æ›¿ãˆï¼‰
  const reranked = await rerankResults(query, results, {
    topK: 5  // æœ€çµ‚çš„ã«5ä»¶ã«çµã‚‹
  })

  // 5. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ§‹ç¯‰
  return {
    knowledge: reranked.filter(r => r.type === 'knowledge'),
    documents: reranked.filter(r => r.type === 'document'),
    chatHistory: await getRecentChatHistory(userId, 10)
  }
}

/**
 * ãƒªãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆé–¢é€£æ€§ã®é«˜ã„ã‚‚ã®ã‚’å„ªå…ˆï¼‰
 */
async function rerankResults(
  query: string,
  results: SearchResult[],
  options: { topK: number }
): Promise<SearchResult[]> {
  // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
  const scored = results.map(result => {
    let score = result.similarity  // ãƒ™ã‚¯ãƒˆãƒ«é¡ä¼¼åº¦

    // æœ€è¿‘ã®ã‚‚ã®ã‚’å„ªå…ˆ
    const daysSinceCreated = (Date.now() - result.created_at) / (1000 * 60 * 60 * 24)
    if (daysSinceCreated < 7) score += 0.1

    // ä½¿ç”¨å›æ•°ãŒå¤šã„ã‚‚ã®ã‚’å„ªå…ˆï¼ˆãƒŠãƒ¬ãƒƒã‚¸ã®å ´åˆï¼‰
    if (result.usage_count > 10) score += 0.05

    // è©•ä¾¡ãŒé«˜ã„ã‚‚ã®ã‚’å„ªå…ˆ
    if (result.rating > 4) score += 0.05

    return { ...result, finalScore: score }
  })

  // ã‚¹ã‚³ã‚¢é †ã«ã‚½ãƒ¼ãƒˆ & ä¸Šä½Kä»¶
  return scored
    .sort((a, b) => b.finalScore - a.finalScore)
    .slice(0, options.topK)
}
```

**å®Ÿè£…ã‚¿ã‚¹ã‚¯:**
- [ ] ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢é–¢æ•°ï¼ˆSupabaseï¼‰
- [ ] ãƒªãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯
- [ ] ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°ç”Ÿæˆï¼ˆOpenAI/Voyage AIï¼‰
- [ ] ãƒãƒ£ãƒƒãƒˆç”»é¢ã§ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤ºï¼ˆã©ã®ãƒŠãƒ¬ãƒƒã‚¸/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ãŸã‹ï¼‰

**æˆåŠŸåŸºæº–:**
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ < 3ç§’
- é–¢é€£æ€§ã®é«˜ã„æƒ…å ±ã®ã¿ã‚’å–å¾—ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼è©•ä¾¡ > 80%ï¼‰

---

#### 4. ãƒŠãƒ¬ãƒƒã‚¸ç®¡ç† ğŸ”¥

**æ©Ÿèƒ½:**
- ã‚ˆãèã‹ã‚Œã‚‹è³ªå•ã‚’ãƒŠãƒ¬ãƒƒã‚¸åŒ–
- ã€Œã“ã‚Œæ¯å›èã‹ã‚Œã‚‹ã‚ã€â†’ ãƒœã‚¿ãƒ³1ã¤ã§ãƒŠãƒ¬ãƒƒã‚¸ç™»éŒ²
- éƒ¨ç½²å†…å…±æœ‰ or å…¨ç¤¾å…±æœ‰

**å®Ÿè£…:**

```typescript
// ãƒãƒ£ãƒƒãƒˆç”»é¢ã«ã€ŒãƒŠãƒ¬ãƒƒã‚¸åŒ–ã€ãƒœã‚¿ãƒ³
async function createKnowledgeFromChat(
  chatId: string,
  messageIds: string[]
): Promise<Knowledge> {
  // ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—
  const messages = await getMessages(messageIds)

  // AIã§è¦ç´„ + ã‚¿ã‚¤ãƒˆãƒ«ç”Ÿæˆ
  const summary = await summarizeToKnowledge(messages)

  // ãƒŠãƒ¬ãƒƒã‚¸ä½œæˆ
  return await supabase.from('knowledge').insert({
    title: summary.title,
    content: summary.content,
    category: 'FAQ',
    source_chat_id: chatId,
    created_by: userId,
    visibility: 'department'  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯éƒ¨ç½²å†…å…±æœ‰
  })
}
```

**å®Ÿè£…ã‚¿ã‚¹ã‚¯:**
- [ ] ãƒŠãƒ¬ãƒƒã‚¸ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
- [ ] ãƒãƒ£ãƒƒãƒˆã‹ã‚‰ã®ãƒŠãƒ¬ãƒƒã‚¸åŒ–æ©Ÿèƒ½
- [ ] ãƒŠãƒ¬ãƒƒã‚¸ä¸€è¦§ãƒ»æ¤œç´¢ç”»é¢
- [ ] ãƒŠãƒ¬ãƒƒã‚¸ç·¨é›†ãƒ»å‰Šé™¤æ©Ÿèƒ½
- [ ] ä½¿ç”¨å›æ•°ãƒ»è©•ä¾¡ã®ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°

---

#### 5. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç† ğŸ”¥

**æ©Ÿèƒ½:**
- ä¼šè­°è³‡æ–™ã€è­°äº‹éŒ²ã€ææ¡ˆæ›¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- AIãŒãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º + ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°ç”Ÿæˆ
- ãƒãƒ£ãƒƒãƒˆã§ã€Œã€‡ã€‡ã®ä¼šè­°è³‡æ–™ã‚ã‚‹ï¼Ÿã€ã¨èã‘ã‚‹

**å®Ÿè£…:**

```typescript
// ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
async function uploadDocument(
  file: File,
  metadata: {
    title: string
    type: 'Meeting' | 'Proposal' | 'Report' | 'Contract'
    visibility: 'company' | 'department' | 'private'
  }
): Promise<Document> {
  // 1. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Supabase Storageã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  const { data: uploadData } = await supabase.storage
    .from('documents')
    .upload(`${companyId}/${documentId}/${file.name}`, file)

  // 2. ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º
  const text = await extractText(file)  // PDF/DOCXå¯¾å¿œ

  // 3. ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°ç”Ÿæˆ
  const embedding = await generateEmbedding(text)

  // 4. DBã«ä¿å­˜
  return await supabase.from('documents').insert({
    ...metadata,
    file_url: uploadData.path,
    content: text,
    embedding: embedding,
    company_id: companyId,
    department_id: departmentId,
    created_by: userId
  })
}
```

**å®Ÿè£…ã‚¿ã‚¹ã‚¯:**
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ï¼ˆPDF/DOCXå¯¾å¿œï¼‰
- [ ] ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡ºï¼ˆpdf-parse, mammoth.jsï¼‰
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸€è¦§ãƒ»æ¤œç´¢ç”»é¢
- [ ] ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½

---

#### 6. çµŒå–¶æŒ‡ç¤ºã®è‡ªå‹•å±•é–‹ ğŸ”¥

**ï¼ˆåˆç‰ˆãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã¨åŒã˜ï¼‰**

çµŒå–¶è€…ã®ä¸€è¨€ â†’ å„éƒ¨é–€ã¸ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³è‡ªå‹•ç”Ÿæˆ

**å®Ÿè£…ã‚¿ã‚¹ã‚¯:**
- [ ] çµŒå–¶è€…å‘ã‘å…¥åŠ›ç”»é¢
- [ ] éƒ¨é–€åˆ¥AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè£…
- [ ] ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé€£æº
- [ ] çµæœè¡¨ç¤ºç”»é¢

---

#### 7. æˆæœç‰©ã®è‡ªå‹•ç”Ÿæˆ ğŸ”¥

**ï¼ˆåˆç‰ˆãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã¨åŒã˜ï¼‰**

ä¼šè­°è³‡æ–™ã€ãƒ¬ãƒãƒ¼ãƒˆã€ææ¡ˆæ›¸ã®è‡ªå‹•ç”Ÿæˆ

**è¿½åŠ :**
- ç”Ÿæˆã—ãŸæˆæœç‰©ã‚’è‡ªå‹•çš„ã«ã€Œãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†ã€ã«ä¿å­˜

**å®Ÿè£…ã‚¿ã‚¹ã‚¯:**
- [ ] ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­è¨ˆ
- [ ] ç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³
- [ ] PDF/DOCXå¤‰æ›
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†ã¸ã®è‡ªå‹•ä¿å­˜

---

### ğŸ”” çµ„ç¹”é€£æºæ©Ÿèƒ½

#### 8. é€šçŸ¥ + ã‚¿ã‚¹ã‚¯ç®¡ç†ï¼ˆç°¡æ˜“ç‰ˆï¼‰

**Phase 1ã®ç¯„å›²:**
- ã‚¿ã‚¹ã‚¯ãŒæŒ¯ã‚‰ã‚ŒãŸã‚‰é€šçŸ¥
- ã‚¿ã‚¹ã‚¯ä¸€è¦§è¡¨ç¤º
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°ï¼ˆæœªç€æ‰‹ / é€²è¡Œä¸­ / å®Œäº†ï¼‰

**å®Ÿè£…:**

```typescript
// ã‚¿ã‚¹ã‚¯ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE tasks (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  company_id UUID NOT NULL REFERENCES companies(id),

  title TEXT NOT NULL,
  description TEXT,
  status TEXT CHECK (status IN ('todo', 'in_progress', 'completed')),
  priority TEXT CHECK (priority IN ('high', 'medium', 'low')),

  -- å‰²ã‚Šå½“ã¦
  assigned_to UUID REFERENCES users(id),
  assigned_by UUID REFERENCES users(id),

  -- é–¢é€£
  related_chat_id UUID REFERENCES chats(id),
  department_id UUID REFERENCES departments(id),

  due_date TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

// é€šçŸ¥ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE notifications (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID NOT NULL REFERENCES users(id),

  type TEXT CHECK (type IN ('task_assigned', 'task_completed', 'mention', 'system')),
  title TEXT NOT NULL,
  message TEXT,

  -- é–¢é€£
  related_task_id UUID REFERENCES tasks(id),
  related_chat_id UUID REFERENCES chats(id),

  is_read BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMPTZ DEFAULT NOW()
);
```

**å®Ÿè£…ã‚¿ã‚¹ã‚¯:**
- [ ] ã‚¿ã‚¹ã‚¯ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
- [ ] é€šçŸ¥ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
- [ ] ã‚¿ã‚¹ã‚¯ä½œæˆãƒ»å‰²ã‚Šå½“ã¦æ©Ÿèƒ½
- [ ] é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ï¼ˆSupabase Realtimeï¼‰
- [ ] ç°¡æ˜“ã‚¿ã‚¹ã‚¯ä¸€è¦§ç”»é¢

**Phase 2ã§æ‹¡å¼µäºˆå®š:**
- ã‚«ãƒ³ãƒãƒ³ãƒœãƒ¼ãƒ‰
- ã‚¿ã‚¹ã‚¯ã®è©³ç´°ç®¡ç†
- ã‚µãƒ–ã‚¿ã‚¹ã‚¯

---

### Phase 1 å®Œäº†åŸºæº–ï¼ˆä¿®æ­£ç‰ˆï¼‰

âœ… **ãƒ‡ãƒ¢ãŒã§ãã‚‹çŠ¶æ…‹:**
1. æ³•äººç™»éŒ² â†’ éƒ¨ç½²ä½œæˆ â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‹›å¾…
2. æ¨©é™ç®¡ç†ãŒå‹•ä½œï¼ˆå–¶æ¥­éƒ¨ã¯äººäº‹éƒ¨ã®ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã‚Œãªã„ï¼‰
3. AIãƒãƒ£ãƒƒãƒˆã§è³ªå• â†’ æœ€é©ãªãƒŠãƒ¬ãƒƒã‚¸/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦å›ç­”
4. çµŒå–¶æŒ‡ç¤º â†’ å„éƒ¨é–€ã¸ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ç”Ÿæˆ
5. ã‚ˆãèã‹ã‚Œã‚‹è³ªå•ã‚’ãƒŠãƒ¬ãƒƒã‚¸åŒ–
6. ä¼šè­°è³‡æ–™ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ ãƒãƒ£ãƒƒãƒˆã§æ¤œç´¢å¯èƒ½
7. ã‚¿ã‚¹ã‚¯ãŒæŒ¯ã‚‰ã‚ŒãŸã‚‰é€šçŸ¥

âœ… **æŠ€è¡“çš„ã«å®‰å®š:**
- ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ
- RLSã§å®‰å…¨ãªãƒ‡ãƒ¼ã‚¿åˆ†é›¢
- RAGãŒé«˜é€Ÿï¼ˆ< 3ç§’ï¼‰

âœ… **ãƒ“ã‚¸ãƒã‚¹çš„ã«æº–å‚™å®Œäº†:**
- æ³•äººå‘ã‘ã®ä¾¡æ ¼è¨­å®š
- åˆ©ç”¨è¦ç´„ï¼ˆãƒ‡ãƒ¼ã‚¿åˆ†é›¢ã®ä¿è¨¼ï¼‰

---

## ğŸ“ˆ Phase 2: åˆæœŸé¡§å®¢ç²å¾— & æ”¹å–„ï¼ˆ2.5-5ãƒ¶æœˆï¼‰

### è¿½åŠ æ©Ÿèƒ½ï¼ˆé¡§å®¢ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ¬¡ç¬¬ï¼‰

#### å„ªå…ˆåº¦ A: é¡§å®¢ã‹ã‚‰å¼·ãè¦æœ›ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒé«˜ã„

##### 1. çµ„ç¹”ç®¡ç†ã®å¼·åŒ–
- [ ] çµ„ç¹”å›³ã®å¯è¦–åŒ–ï¼ˆèª°ãŒã©ã®éƒ¨ç½²ã«ã„ã‚‹ã‹ï¼‰
- [ ] éƒ¨ç½²éšå±¤ã®ç®¡ç†ï¼ˆå–¶æ¥­1èª²ã€å–¶æ¥­2èª²ãªã©ï¼‰
- [ ] ãƒ­ãƒ¼ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

##### 2. ã‚¿ã‚¹ã‚¯ç®¡ç†ã®æœ¬æ ¼åŒ–
- [ ] ã‚«ãƒ³ãƒãƒ³ãƒœãƒ¼ãƒ‰
- [ ] ã‚¬ãƒ³ãƒˆãƒãƒ£ãƒ¼ãƒˆ
- [ ] ã‚¿ã‚¹ã‚¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- [ ] å®šæœŸã‚¿ã‚¹ã‚¯ã®è‡ªå‹•ç”Ÿæˆ

##### 3. å¤–éƒ¨ãƒ„ãƒ¼ãƒ«é€£æº
- [ ] Slacké€šçŸ¥
- [ ] Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æº
- [ ] Salesforceé€£æºï¼ˆå–¶æ¥­ãƒ‡ãƒ¼ã‚¿ï¼‰

##### 4. åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- [ ] éƒ¨é–€åˆ¥ã®æ´»å‹•çŠ¶æ³
- [ ] ã‚ˆãä½¿ã‚ã‚Œã‚‹ãƒŠãƒ¬ãƒƒã‚¸
- [ ] AIã®ç²¾åº¦åˆ†æ

#### å„ªå…ˆåº¦ B: ã‚ã‚‹ã¨è‰¯ã„ãŒå¿…é ˆã§ã¯ãªã„
- [ ] ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª
- [ ] éŸ³å£°å…¥åŠ›
- [ ] ãƒ“ãƒ‡ã‚ªä¼šè­°ã¨ã®é€£æº

---

## ğŸ“Š Phase 1 ã®é–‹ç™ºã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆæ”¹è¨‚ç‰ˆï¼‰

### Week 1-2: åŸºç›¤æ•´å‚™ï¼ˆãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆ + æ¨©é™ç®¡ç†ï¼‰
- [ ] Supabaseã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆï¼ˆcompanies, departments, usersï¼‰
- [ ] RLSãƒãƒªã‚·ãƒ¼å®Ÿè£…
- [ ] æ³•äººç™»éŒ²ãƒ•ãƒ­ãƒ¼
- [ ] éƒ¨ç½²ä½œæˆãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‹›å¾…æ©Ÿèƒ½
- [ ] æ¨©é™ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰

### Week 3-4: RAGæœ€é©åŒ– + ãƒŠãƒ¬ãƒƒã‚¸/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [ ] ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢å®Ÿè£…ï¼ˆSupabaseé–¢æ•°ï¼‰
- [ ] ãƒªãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯
- [ ] ãƒŠãƒ¬ãƒƒã‚¸ãƒ†ãƒ¼ãƒ–ãƒ« + CRUD
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ†ãƒ¼ãƒ–ãƒ« + ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- [ ] ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡ºï¼ˆPDF/DOCXï¼‰
- [ ] ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°ç”Ÿæˆ

### Week 5-6: AIãƒãƒ£ãƒƒãƒˆæ”¹å–„
- [ ] ãƒãƒ£ãƒƒãƒˆç”»é¢æ”¹å–„ï¼ˆå‚ç…§ã—ãŸãƒŠãƒ¬ãƒƒã‚¸/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¡¨ç¤ºï¼‰
- [ ] ãƒãƒ£ãƒƒãƒˆã‹ã‚‰ã®ãƒŠãƒ¬ãƒƒã‚¸åŒ–æ©Ÿèƒ½
- [ ] ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¿œç­”ã®å®‰å®šåŒ–
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### Week 7-8: ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ + æˆæœç‰©ç”Ÿæˆ
- [ ] çµ±æ‹¬ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè£…
- [ ] éƒ¨é–€åˆ¥ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè£…
- [ ] ä¸¦åˆ—å®Ÿè¡Œåˆ¶å¾¡
- [ ] æˆæœç‰©ç”Ÿæˆï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ3ç¨®é¡ï¼‰
- [ ] PDF/DOCXå¤‰æ›

### Week 9-10: é€šçŸ¥ + ã‚¿ã‚¹ã‚¯ + ä»•ä¸Šã’
- [ ] ã‚¿ã‚¹ã‚¯ãƒ†ãƒ¼ãƒ–ãƒ« + CRUD
- [ ] é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ï¼ˆSupabase Realtimeï¼‰
- [ ] ç°¡æ˜“ã‚¿ã‚¹ã‚¯ä¸€è¦§ç”»é¢
- [ ] å…¨ä½“çš„ãªãƒã‚°ä¿®æ­£
- [ ] ãƒ‡ãƒ¢ç’°å¢ƒæ§‹ç¯‰

---

## ğŸ¯ æ©Ÿèƒ½ã®å„ªå…ˆé †ä½ãƒãƒˆãƒªã‚¯ã‚¹

### å£²ä¸Šã¸ã®è²¢çŒ®åº¦ Ã— å®Ÿè£…é›£æ˜“åº¦

```
é«˜è²¢çŒ® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”‚  â­æ¨©é™ç®¡ç†      â­RAGæœ€é©åŒ–
â”‚  â­ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆ â­çµŒå–¶æŒ‡ç¤ºè‡ªå‹•å±•é–‹
â”‚
â”‚  ãƒŠãƒ¬ãƒƒã‚¸ç®¡ç†   ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†
â”‚  AIãƒãƒ£ãƒƒãƒˆ     æˆæœç‰©ç”Ÿæˆ
â”‚
â”‚  é€šçŸ¥          ã‚¿ã‚¹ã‚¯ç®¡ç†ï¼ˆç°¡æ˜“ï¼‰
â”‚
â”‚  ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰  çµ„ç¹”å›³
â”‚
ä½è²¢çŒ® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      ä½é›£æ˜“åº¦               é«˜é›£æ˜“åº¦
```

### Phase 1ã§å®Ÿè£…ã™ã‚‹ã‚‚ã®ï¼ˆâ­ãƒãƒ¼ã‚¯ï¼‰

1. **ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆ + æ¨©é™ç®¡ç†** â†’ æ³•äººå‘ã‘ã«å¿…é ˆ
2. **RAGæœ€é©åŒ–** â†’ æ—¢å­˜æ©Ÿèƒ½ã®æ”¹å–„ï¼ˆã‚³ã‚¢ä½“é¨“ã®è³ªå‘ä¸Šï¼‰
3. **çµŒå–¶æŒ‡ç¤ºè‡ªå‹•å±•é–‹** â†’ æœ€å¤§ã®å·®åˆ¥åŒ–ãƒã‚¤ãƒ³ãƒˆ
4. **ãƒŠãƒ¬ãƒƒã‚¸ + ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†** â†’ æ³•äººã§ã®å®Ÿç”¨æ€§
5. **AIãƒãƒ£ãƒƒãƒˆ** â†’ ã™ã§ã«ã‚ã‚‹ã®ã§æ”¹å–„
6. **æˆæœç‰©ç”Ÿæˆ** â†’ ãƒ‡ãƒ¢ã§ã€ŒãŠãŠï¼ã€ã¨ãªã‚‹
7. **é€šçŸ¥ + ã‚¿ã‚¹ã‚¯ï¼ˆç°¡æ˜“ï¼‰** â†’ çµ„ç¹”é€£æºã®æœ€å°é™

---

## ğŸ’° ã‚³ã‚¹ãƒˆè©¦ç®—ï¼ˆPhase 1ï¼‰

### é–‹ç™ºã‚³ã‚¹ãƒˆ
- é–‹ç™ºæœŸé–“: 10é€±é–“ï¼ˆ2.5ãƒ¶æœˆï¼‰
- é–‹ç™ºè€…æ•°: 2-3åæƒ³å®š
- ç·é–‹ç™ºæ™‚é–“: ç´„400-600æ™‚é–“

### é‹ç”¨ã‚³ã‚¹ãƒˆï¼ˆæœˆé¡ï¼‰
```
Supabase Pro: $25
Claude API: $500ï¼ˆé–‹ç™º + åˆæœŸãƒ†ã‚¹ãƒˆï¼‰
OpenAI Embeddings: $50
Vercel Pro: $20
åˆè¨ˆ: ç´„$595/æœˆï¼ˆÂ¥90,000ï¼‰
```

### åˆæœŸé¡§å®¢ç²å¾—å¾Œï¼ˆ5ç¤¾æƒ³å®šï¼‰
```
Supabase Pro: $25
Claude API: $2,000ï¼ˆæœ¬ç•ªåˆ©ç”¨ï¼‰
OpenAI Embeddings: $200
Vercel Pro: $20
åˆè¨ˆ: ç´„$2,245/æœˆï¼ˆÂ¥340,000ï¼‰

åç›Šï¼ˆ5ç¤¾ Ã— Â¥100,000ï¼‰: Â¥500,000
åˆ©ç›Š: Â¥160,000/æœˆ
```

---

## ğŸ ã¾ã¨ã‚

### Phase 1ã§å®Ÿç¾ã™ã‚‹ã“ã¨ï¼ˆä¿®æ­£ç‰ˆï¼‰

âœ… **æ³•äººå‘ã‘ã®åŸºç›¤**
- ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ
- éƒ¨ç½²ãƒ»æ¨©é™ç®¡ç†
- ãƒ‡ãƒ¼ã‚¿åˆ†é›¢

âœ… **é«˜å“è³ªãªAIãƒãƒ£ãƒƒãƒˆ**
- RAGæœ€é©åŒ–ï¼ˆé–¢é€£æ€§ã®é«˜ã„æƒ…å ±ã®ã¿ï¼‰
- ãƒŠãƒ¬ãƒƒã‚¸ + ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†
- ãƒãƒ£ãƒƒãƒˆå±¥æ­´

âœ… **å·®åˆ¥åŒ–æ©Ÿèƒ½**
- çµŒå–¶æŒ‡ç¤ºã®è‡ªå‹•å±•é–‹
- ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé€£æº
- æˆæœç‰©ã®è‡ªå‹•ç”Ÿæˆ

âœ… **çµ„ç¹”é€£æº**
- é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 
- ç°¡æ˜“ã‚¿ã‚¹ã‚¯ç®¡ç†

### æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

#### ä»Šã™ã
- [ ] ã“ã®ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æ‰¿èª
- [ ] é–‹ç™ºä½“åˆ¶ã®ç¢ºèªï¼ˆèª°ãŒä½•ã‚’æ‹…å½“ï¼Ÿï¼‰

#### 1é€±é–“ä»¥å†…
- [ ] Supabaseã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆã®è©³ç´°åŒ–
- [ ] RLSãƒãƒªã‚·ãƒ¼ã®è¨­è¨ˆ
- [ ] ãƒŠãƒ¬ãƒƒã‚¸ vs ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®UIè¨­è¨ˆ

#### 2é€±é–“ä»¥å†…
- [ ] Phase 1 Week 1-2ã®å®Ÿè£…é–‹å§‹
- [ ] åˆæœŸãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆ5-10ç¤¾ï¼‰

---

**ä½œæˆè€…**: Claude Code
**æœ€çµ‚æ›´æ–°**: 2025å¹´11æœˆ23æ—¥
